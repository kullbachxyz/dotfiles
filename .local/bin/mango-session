#!/bin/sh

# Session defaults
export TERMINAL=alacritty
export EDITOR=nvim
export BROWSER=librewolf

# Wayland app preferences
export MOZ_ENABLE_WAYLAND=1
export QT_QPA_PLATFORM=wayland
export SDL_VIDEODRIVER=wayland
export CLUTTER_BACKEND=wayland

# Desktop/session hints
export XDG_CURRENT_DESKTOP=mangowc
export XDG_SESSION_TYPE=wayland

# Theme preferences (optional)
export GTK_THEME=Adwaita-dark
export QT_QPA_PLATFORMTHEME=qt6ct
export QT_STYLE_OVERRIDE=kvantum

# SHH
export SSH_AUTH_SOCK="$XDG_RUNTIME_DIR/ssh-agent.socket"

#  # start agent if missing or not responding
if [ ! -S "$SSH_AUTH_SOCK" ] || ! ssh-add -l >/dev/null 2>&1; then
  rm -f "$SSH_AUTH_SOCK"
  eval "$(ssh-agent -s -a "$SSH_AUTH_SOCK")" >/dev/null
  ssh-add ~/.ssh/id_ed25519 >/dev/null 2>&1
fi

# exec mango -s ~/.config/mango/autostart.sh
exec dbus-run-session -- mango -s ~/.config/mango/autostart.sh
